var captchaRes='';var pakatVerifyCallback=function(response){ captchaRes = response;   if(captchaRes)
   {      var validationErr = 0;      jQuery.each(jQuery('.pakat_signup_form').find('input[required=required]'), function(){if(jQuery(this).val().trim()==''||(jQuery(this).attr('type')=="checkbox"&&jQuery(this).prop("checked")==false))
      {        validationErr++;        var form = jQuery(this).closest('form');        form.find('.pakat_msg_disp').html('<p class="pakat-alert-message pakat-alert-message-warning ">' + pakatErrMsg.requiredField + '</p>').show();        return;                
      }
      });   }
   if(validationErr == 0) {       jQuery('.pakat_signup_form').trigger('submit');   }};jQuery(document).ready(function(){jQuery('.pakat_signup_form').find('input[required=required]').on("invalid",function(){if(jQuery(this).val().trim()=='')
{var alert_msg=jQuery(this).closest('form').find('input[name="pakat_form_alert_notice"]').val();this.setCustomValidity(alert_msg);}
else{this.setCustomValidity('');}});jQuery(document).on('submit','form',function(e){if(!jQuery(this).hasClass('pakat_signup_form')){var email=jQuery(this).find('input[type=email]').val();var emailPattern=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(typeof pakat!='undefined'&&email!=null&&emailPattern.test(email)){var postData=jQuery(this).serializeObject();pakat.identify(email,postData);}}
else
{e.preventDefault();var form=jQuery(this).closest('form');jQuery.each(form.find('.pakat-sms'),function(){var sms=jQuery(this).val();var sms_prefix=jQuery(this).closest('.pakat-sms-field').find('input[name="pakat_SMS_prefix"]').val();if(sms==sms_prefix&&!jQuery(this).prop('required')){jQuery(this).val('');}});var required_fileds=[];var err_index=0;var multi_lists=form.find(jQuery('.pakat-multi-lists'));if(multi_lists!=undefined&&multi_lists.data('require')=='required')
{if(multi_lists.find('input:checked').length==0)
{err_index++;multi_lists.addClass('pakat_error');}}
if(err_index>0)
{form.find('.pakat_msg_disp').html('<p class="pakat-alert-message pakat-alert-message-warning ">'+pakatErrMsg.requiredField+'</p>').show();return;}
err_index=0;jQuery.each(form.find('input[type="email"]'),function(){var Email=/^([a-zA-Z0-9_.+-])+@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/i;if(!Email.test(jQuery(this).val()))
{err_index++;}});if(err_index>0)
{form.find('.pakat_msg_disp').html('<p class="pakat-alert-message pakat-alert-message-warning ">'+pakatErrMsg.invalidMail+'</p>').show();return;}
err_index=0;jQuery.each(form.find('.pakat-sms'),function(){var sms=jQuery(this).val();if(is_valid_sms(sms)==false&&sms!=''){err_index++;}});if(err_index>0)
{form.find('.pakat_msg_disp').html('<p class="pakat-alert-message pakat-alert-message-warning ">'+pakatErrMsg.invalidSMSFormat+'</p>').show();return;}
form.find('.pakat_loader').show();jQuery('.pakat_msg_disp').hide();var postData=form.serializeArray();if(captchaRes!='')
{postData.push({"name":"g-recaptcha-response","value":captchaRes});}
if(jQuery('.pakat-multi-lists').length)
{var interesting_lists=[];jQuery('.pakat-interesting-lists').each(function(){postData.push({"name":"interestingLists[]","value":jQuery(this).val()})});}
var formURL=form.attr("action");form.addClass('pakat_processing');postData.push({"name":"security","value":ajax_pakat_front_object.ajax_nonce});jQuery.ajax({url:formURL,type:"POST",dataType:"json",data:postData,success:function(data,textStatus,jqXHR){jQuery('.pakat_loader').hide();if(jQuery('.pakat-multi-lists').length)
{jQuery('.pakat-multi-lists').removeClass('pakat_error');}
if(data.status==='success'||data.status==='update'){var cdata='<p class="pakat-alert-message pakat-alert-message-success ">'+data.msg.successMsg+'</p>';form.find('.pakat_msg_disp').html(cdata).show();}else if(data.status==='failure'){var cdata='<p class="pakat-alert-message pakat-alert-message-error ">'+data.msg.errorMsg+'</p>';form.find('.pakat_msg_disp').html(cdata).show();}else if(data.status==='already_exist'){var cdata='<p class="pakat-alert-message pakat-alert-message-warning ">'+data.msg.existMsg+'</p>';form.find('.pakat_msg_disp').html(cdata).show();}else if(data.status==='invalid'){var cdata='<p class="pakat-alert-message pakat-alert-message-error ">'+data.msg.invalidMsg+'</p>';form.find('.pakat_msg_disp').html(cdata).show();}else if(data.status==='gcaptchaEmpty'){var cdata='<p class="pakat-alert-message pakat-alert-message-error ">'+data.msg+'</p>';form.find('.pakat_msg_disp').html(cdata).show();}else if(data.status==='gcaptchaFail'){var cdata='<p class="pakat-alert-message pakat-alert-message-error ">'+data.msg+'</p>';form.find('.pakat_msg_disp').html(cdata).show();}
form[0].reset();if(data.redirect&&(data.status==='success'||data.status==='update')){window.location.href=data.redirect;}
var previous_code=form.find('.pakat-cflags').data('dial-code');if(previous_code)
{form.find('.pakat-sms').val('+'+previous_code);form.find('input[name="pakat_SMS_prefix"]').val('+'+previous_code);}
if(typeof pakat!='undefined'){var email=form.find('input[name=email]').val();var postData=form.serializeObject();if(data.status==='success'||data.status==='update'||data.status==='already_exist'){pakat.identify(email,postData);}}
jQuery(".pakat-alert-message").delay(2000).hide('slow');form.removeClass('pakat_processing');if(typeof grecaptcha!='undefined')
{grecaptcha.reset(gCaptchaPakatWidget);}},error:function(jqXHR,textStatus,errorThrown){form.find('.pakat_msg_disp').html(jqXHR).show();if(typeof grecaptcha!='undefined')
{grecaptcha.reset(gCaptchaPakatWidget);}}});}});jQuery('.pakat-country-block').on('click',function(){jQuery('.pakat-country-list').toggle();});if(jQuery('.pakat-country-list').length>0)
{jQuery('.pakat-country-list').ready(function(){var data={action:'pakat_get_country_prefix',security:ajax_pakat_front_object.ajax_nonce,};jQuery.post(ajax_pakat_front_object.ajax_url,data,function(respond){jQuery('.pakat-country-list').html(respond);});});}
jQuery('body').on('click',function(e){if(jQuery('.pakat-sms-field .pakat-country-list').length>0&&!jQuery('.pakat-sms-field .pakat-country-list').is(e.target)&&jQuery('.pakat-sms-field .pakat-country-list').has(e.target).length===0&&jQuery('.pakat-sms-field .pakat-country-block').has(e.target).length===0){jQuery('.pakat-sms-field .pakat-country-list').hide();}});jQuery('.pakat-country-list').on('click','li',function(){var country_code=jQuery(this).data('country-code').toLowerCase();var dial_code=jQuery(this).data('dial-code');jQuery(this).closest('.pakat-sms-field').find('.pakat-sms').val('+'+dial_code);jQuery(this).closest('.pakat-sms-field').find('input[name="pakat_SMS_prefix"]').val('+'+dial_code);jQuery(this).closest('.pakat-sms-field').find('.pakat-cflags').css('background-image','url('+ajax_pakat_front_object.flag_url+country_code+'.png)');jQuery(this).closest('.pakat-sms-field').find('.pakat-cflags').data('dial-code',dial_code);jQuery(this).closest('.pakat-country-list').hide();});jQuery(".pakat-sms").on('keypress',function(event){validateInteger(event,'sms');});jQuery(".pakat-date").on('keypress',function(event){validateInteger(event,'date');});function is_valid_sms(sms){sms=sms.replace(/\b(0(?!\b))+/g,"");var tempSms=sms.replace(/( |\(|\)|\.|\-)/g,'');if(tempSms.length>19||tempSms.length<6||tempSms.charAt(0)!='+'){return false;}
return true;}
function validateInteger(evt,type){var theEvent=evt||window.event;var key=theEvent.charCode||theEvent.which;key=String.fromCharCode(key);var regex=/[ +0-9()-]/;var smsLength=0;if(type=='date'){regex=/[ 0-9-/]/;}
if(!regex.test(key)){theEvent.returnValue=false;key=theEvent.keyCode;if(theEvent.preventDefault&&key!=9&&key!=8)theEvent.preventDefault();}}});jQuery.fn.serializeObject=function()
{var o={};var a=this.serializeArray();jQuery.each(a,function(){if(this.name=='pakat_form_action'||this.name=='pakat_form_id'||this.name=='email')
return true;if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]];}
o[this.name].push(this.value||'');}else{o[this.name]=this.value||'';}});return o;};